package ms.pe.project.oauth.services;import ms.pe.project.oauth.clients.UserClient;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.security.core.GrantedAuthority;import org.springframework.security.core.authority.SimpleGrantedAuthority;import org.springframework.security.core.userdetails.User;import org.springframework.security.core.userdetails.UserDetails;import org.springframework.security.core.userdetails.UserDetailsService;import org.springframework.security.core.userdetails.UsernameNotFoundException;import org.springframework.stereotype.Service;import java.util.List;import java.util.stream.Collectors;@Servicepublic class UserService implements UserDetailsService,IUserService {    @Autowired    private UserClient client;    @Override    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {        ms.pe.project.commonuser.models.entity.User user=client.findByUsername(username);        if(user == null){            throw new UsernameNotFoundException("Error en el login...");        }        List<GrantedAuthority> authorities=user.roles                .stream()                .map(role -> new SimpleGrantedAuthority(role.name))                .collect(Collectors.toList());        return new User(                user.username,                user.password,                user.active,                true,                true,                true,                authorities                );    }    @Override    public ms.pe.project.commonuser.models.entity.User findByUsername(String username) {        return client.findByUsername(username);    }}